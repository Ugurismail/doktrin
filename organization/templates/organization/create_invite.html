{% extends 'base.html' %}

{% block title %}Davet Kodu Oluştur - Doktrin Platformu{% endblock %}

{% block content %}
<div class="container form-container">
    <div class="back-link-container">
        <a href="{% url 'organization:my_team' %}" class="back-link">← Ekibime Dön</a>
    </div>

    <div class="card">
        <h1 class="page-title">Davet Kodu Oluştur</h1>

        <p class="user-location-info">
            Yeni üyeleri ekibinize davet etmek için bir kod oluşturun.
            Kod 7 gün boyunca geçerli olacaktır.
        </p>

        <form method="post" class="mt-lg">
            {% csrf_token %}
            <p class="mb-md">
                <strong>Ekip:</strong> {{ user.current_team.display_name }}
            </p>

            <button type="submit" class="btn btn-primary btn-full-width">Davet Kodu Oluştur</button>
        </form>
    </div>

    <div class="card mt-lg">
        <h2 class="card-title">Mevcut Davet Kodları</h2>

        {% if user.current_team.invite_codes.all %}
        <table class="invite-table">
            <thead>
                <tr class="invite-table-header">
                    <th class="invite-table-th">Kod</th>
                    <th class="invite-table-th">Durum</th>
                    <th class="invite-table-th">Bitiş</th>
                </tr>
            </thead>
            <tbody>
                {% for invite in user.current_team.invite_codes.all %}
                <tr>
                    <td class="invite-table-td invite-code-text">{{ invite.code }}</td>
                    <td class="invite-table-td">
                        {% if invite.is_used %}
                            <span class="status-used">Kullanıldı</span>
                        {% else %}
                            <span class="status-active">Aktif</span>
                        {% endif %}
                    </td>
                    <td class="invite-table-td">{{ invite.expires_at|date:"d.m.Y" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="empty-message">Henüz davet kodu oluşturulmamış.</p>
        {% endif %}
    </div>
</div>
{% endblock %}