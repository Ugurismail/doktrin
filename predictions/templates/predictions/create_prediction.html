{% extends 'base.html' %}

{% block title %}Tahmin Oluştur{% endblock %}

{% block content %}

<style>
/* Takvim ikonu her modda görünür olsun */
input[type="datetime-local"]::-webkit-calendar-picker-indicator {
    filter: invert(0.5) brightness(0.8);
    cursor: pointer;
    opacity: 1;
}

[data-theme="dark"] input[type="datetime-local"]::-webkit-calendar-picker-indicator {
    filter: invert(1) brightness(1.2);
    opacity: 1;
}
</style>

<div style="max-width: 800px; margin: 0 auto; padding: var(--space-lg) var(--space-md);">
    <div style="margin-bottom: var(--space-lg);">
        <h1 style="font-size: 32px; font-weight: 600; margin-bottom: var(--space-sm);">Tahmin Oluştur</h1>
        <p style="color: var(--text-secondary);">Gelecek hakkında bir öngörü paylaşın</p>
    </div>

    <form method="post" style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius); padding: var(--space-lg);">
        {% csrf_token %}

        <div style="margin-bottom: var(--space-md);">
            <label style="display: block; margin-bottom: var(--space-xs); font-weight: 500;">Tahmin</label>
            <input type="text" name="title" required maxlength="300" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: var(--radius); background: var(--bg); color: var(--text);" placeholder="Tahmininizi net bir şekilde girin">
        </div>

        <div style="margin-bottom: var(--space-md);">
            <label style="display: block; margin-bottom: var(--space-xs); font-weight: 500;">Açıklama</label>
            <textarea name="description" required rows="8" style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: var(--radius); background: var(--bg); color: var(--text); resize: vertical;" placeholder="Tahmininizin detayları"></textarea>
        </div>

        <div style="margin-bottom: var(--space-lg);">
            <label style="display: block; margin-bottom: var(--space-xs); font-weight: 500;">Bitiş Tarihi</label>
            <input type="datetime-local" name="deadline" required style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: var(--radius); background: var(--bg); color: var(--text);">
            <p style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Birkaç gün sonrasından 10 yıl sonrasına kadar seçebilirsiniz</p>
        </div>

        <div style="display: flex; gap: var(--space-sm);">
            <button type="submit" class="btn btn-primary">Tahmin Oluştur</button>
            <a href="{% url 'predictions:prediction_list' %}" class="btn btn-secondary">İptal</a>
        </div>
    </form>
</div>

<script>
// Minimum ve maksimum tarihleri ayarla
document.addEventListener('DOMContentLoaded', function() {
    const dateInput = document.querySelector('input[name="deadline"]');
    
    // Minimum: Şu andan 1 saat sonra
    const now = new Date();
    now.setHours(now.getHours() + 1);
    const minDate = now.toISOString().slice(0, 16);
    
    // Maksimum: 10 yıl sonra
    const maxDate = new Date();
    maxDate.setFullYear(maxDate.getFullYear() + 10);
    const maxDateStr = maxDate.toISOString().slice(0, 16);
    
    dateInput.setAttribute('min', minDate);
    dateInput.setAttribute('max', maxDateStr);
});
</script>

{% endblock %}
